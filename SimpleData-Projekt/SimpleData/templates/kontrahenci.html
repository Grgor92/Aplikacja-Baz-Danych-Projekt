{% extends "layout.html" %}
{%block content%}

<div class="search-form" style="text-align: center;">
    <h2>Panel kontrahent√≥w</h2>
    <form action="{{ url_for('kontrahenci_t') }}" method="post" style="display: inline-block;">
        <div class="search-fields">
            <div class="input-wrapper">
                <label for="nip">NIP</label>
                <input type="text" id="nip" name="nip" optional>
            </div>

            <div class="input-wrapper">
                <label for="nazwa_firmy">Nazwa firmy</label>
                <input type="text" id="nazwa_firmy" name="nazwa_firmy" optional>
            </div>
        </div>
        <button id="wyszukajBtn" type="submit" style="display: block; margin-top: 10px;">Wyszukaj</button>
    </form>
</div>


<button id="add-record-btn" onclick="openDodajPopup()">Dodaj kontrahenta</button>


<div id="dodajPopup" class="popup">
    <div class="content">
        <span class="close" onclick="closeDodajPopup()">&times;</span>
        <h2>Dodaj</h2>
        <form action="{{ url_for('dodaj_rekord') }}" method="POST">
            <label for="nip">NIP:</label>
            <input type="text" id="nip" name="nip" required>

            <label for="nazwa_firmy">Nazwa firmy:</label>
            <input type="text" id="nazwa_firmy" name="nazwa_firmy" required>

            <label for="miasto">Miasto:</label>
            <input type="text" id="miasto" name="miasto" required>

            <label for="nr_telefonu">Numer telefonu:</label>
            <input type="text" id="nr_telefonu" name="nr_telefonu" required>

            <label for="ulica">Ulica:</label>
            <input type="text" id="ulica" name="ulica" required>

            <label for="numer">Numer:</label>
            <input type="text" id="numer" name="numer" required>

            <button type="submit">Dodaj</button>
        </form>
    </div>
</div>

<div class="table-container">
    <table class="table">
        <thead>
            <tr>
                <th class="header-cell">NIP</th>
                <th class="header-cell">Nazwa firmy</th>
                <th class="header-cell">Miasto</th>
                <th class="header-cell">Numer telefonu</th>
                <th class="header-cell">Ulica</th>
                <th class="header-cell">Numer</th>
                <th class="header-cell">Akcje</th>
            </tr>
        </thead>
        <tbody>
            {% for kontrahent in kontrahenci %}
            <tr>
                <td>{{ kontrahent.NIP }}</td>
                <td>{{ kontrahent.nazwa_firmy }}</td>
                <td>{{ kontrahent.miasto }}</td>
                <td>{{ kontrahent.telefon }}</td>
                <td>{{ kontrahent.ulica }}</td>
                <td>{{ kontrahent.numer }}</td>
                <td>
                    <button onclick="openEditPopup()">Edytuj</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


<div id="editPopup" class="popup">
    <div class="content">
        <span class="close" onclick="closeEditPopup()">&times;</span>
        <h2>Edytuj kontrahenta</h2>
        <form id="editForm" method="post" onsubmit="event.preventDefault(); saveEditedData();">
            <label for="editedField1">NIP :</label>
            <input type="text" id="editedField1" name="editedField1" optional>

            <label for="editedField2">Nazwa firmy 2:</label>
            <input type="text" id="editedField2" name="editedField3" optional>

            <label for="editedField3">Miasto:</label>
            <input type="text" id="editedField3" name="editedField4" optional>

            <label for="editedField4">Numer telefonu:</label>
            <input type="text" id="editedField4" name="editedField5" optional>

            <label for="editedField5">Ulica:</label>
            <input type="text" id="editedField5" name="editedField6" optional>

            <label for="editedField6">Numer:</label>
            <input type="text" id="editedField6 name="editedField7" optional>

            <button type="submit">Zapisz zmiany</button>
        </form>
    </div>
</div>




<script>

    $(document).on("click", ".edit-btn", function () {
        var nip = $(this).data('nip');
        var nazwa_firmy = $(this).data('nazwa_firmy');
        var miasto = $(this).data('miasto');
        var nr_telefonu = $(this).data('nr_telefonu');
        var ulica = $(this).data('ulica');
        var numer = $(this).data('numer');
        $("#nip-input").val(nip);
        $("#nazwa_firmy-input").val(nazwa_firmy);
        $("#miasto-input").val(miasto);
        $("#nr_telefonu-input").val(nr_telefonu);
        $("#ulica-input").val(ulica);
        $("#numer-input").val(numer);
    });

    function openWyszukajPopup() {
        document.getElementById('wyszukajPopup').style.display = 'block';
    }

    function closeWyszukajPopup() {
        document.getElementById('wyszukajPopup').style.display = 'none';
    }

    function openDodajPopup() {
        document.getElementById('dodajPopup').style.display = 'block';
    }

    function closeDodajPopup() {
        document.getElementById('dodajPopup').style.display = 'none';
    }
    function openEditPopup() {
        var dodajPopup = document.getElementById("editPopup");
        dodajPopup.style.display = "block";
    }

    function closeEditPopup() {
        var dodajPopup = document.getElementById("editPopup");
        dodajPopup.style.display = "none";
    }

    


</script>

</div>

{%endblock%}